{% extends "index.html" %}

{% load static %}

{% block title %}
<title>Calculator</title>
{% endblock %}

{% block css %} 
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
{% endblock %}

{% block script %}
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"></script>
<script> let geojsonPath = "{% static 'Net_Metering/json/Prefectures_boundaries.geojson' %}";</script>
<script src="{% static 'Net_Metering/javascript/leaflet_map.js' %}" defer></script>
<script> var calculatePowerURL = "{% url 'simulation:calculate_power' %}";</script>
<script src="{% static 'Net_Metering/javascript/scriptCalculator.js' %}" defer></script>
<script src="https://cdn.jsdelivr.net/npm/@turf/turf@6/turf.min.js"></script>
{% endblock %}

{% block menu_list %}
    <li><a href="{% url 'home' %}"><i class="fas fa-home"></i> home</a></li>
    <li><a class="nav-link active" href="{% url 'simulation:calculator' %}"><i class="fas fa-calculator"></i> calculator</a></li>
    <li><a href="{% url 'simulation:dashboard' %}"><i class="fas fa-qrcode"></i> dashboard</a></li>
    <li><a href="{% url 'simulation:regulations' %}"><i class="fas fa-scale-unbalanced-flip"></i> regulations</a></li>
    <li><a href="{% url 'simulation:about' %}"><i class="fas fa-info-circle"></i> about</a></li>
{% endblock %}

{% block color_theme %}
    <div class="theme-toggle" title="Dark - Light Mode">
        <input type="range" id="theme-slider" min="0" max="1" step="1" value="0">
    </div>
{% endblock %}

{% block content %}

<section class="section-before-calculator">
    <div class="section-middle-position">
        <table class="table-title">
                <tr class="row-in-table-title">
                    <td class="icon-calculator">
                    <i class=" fa fa-calculator" aria-hidden="true"  ></i>
                    </td>
                    <th class="calc-title">
                        <h3>Υπολογιστής Απόδοσης</h3>
                    </th>
                </tr>
        </table>    

        <article class="calculator-article">
            <div class="padding-article">
                Ο υπολογιστής απόδοσης οικιακού φωτοβολταϊκού συστήματος αυτοπαραγωγής με ενεργειακό συμψηφισμό
                (Net Metering), θα σας βοηθήσει να υπολογίσετε την απαραίτητη Ισχύ Φ/Β συστήματος, τον εκτιμώμενο 
                χρόνο απόσβεσης και χρηματο-οικονομικούς δείκτες της επένδυσής σας, βάσει επιλογών εγκατάστασης 
                και καταναλωτικού σας προφίλ.
            </div>
        </article>
    </div>
</section>

    <div class="calculator-page-content">

        <div class="spacer-in-main-content">
            <!-- <h2>Συμπληρώστε τα πεδία</h2> -->
            <div class="navigation-panel">
                <ul id="navigation-ul">
                  <li><a class="panel-field active" href="#panel1"><span class="circle-link active">1</span> Τοποθεσία</a></li>
                  <li><a class="panel-field" href="#panel2"><span class="circle-link">2</span> Εγκατάσταση</a></li>
                  <li><a class="panel-field" href="#panel3"><span class="circle-link">3</span> Αζιμούθιο - Κλίση</a></li>
                  <li><a class="panel-field" href="#panel4"><span class="circle-link">4</span> Κατανάλωση</a></li>
                  <li><a class="panel-field" href="#panel5"><span class="circle-link">5</span> Ισχύς</a></li>
                  <li><a class="panel-field" href="#panel6"><span class="circle-link">6</span> Αποθήκευση</a></li>
                </ul>
            </div>
        </div>

        <!-- ::: CALCULATOR FORM ::: -->
        <div class="calculator-container">

            <!-- <div class="column-calculator-page"></div> -->

            <form method="POST" class="my-form-control" id="calculatorForm" name="calculatorForm" action="{% url 'simulation:calculator' %}" onsubmit="validateForm()">
                {% csrf_token %}

                <fieldset class="calculator-fieldset">
                        <!-- PANEL 1 -->
                        <!-- Here you select installation DISTRICT -->
                        <div class="panel-calculator" id="panel1">

                            <div class="title-panel">
                                <span class="number"> 1 </span>
                                <h4>Τοποθεσία</h4>
                            </div>
                            
                                <div class="option-selector-margin">
                                    
                                    <p id="region-title" title="Παρακαλούμε, επιλέξτε ένα σημείο εντός των γεωγραφικών συνόρων της Ελλάδας. Ο Νομός και οι συντεταγμένες θα εμφανιστούν στα αντίστοιχα πεδία">
                                        <label for="regionInput" class="spacer-label">Επιλέξτε Τοποθεσία Εγκατάστασης Φ/Β Συστήματος στο Χάρτη:</label>

                                        <button class="help-popper" type="button" title="help-button">
                                            <i class="fa fa-question-circle" id="place-info"></i>
                                        </button>
    
                                            <div class="help-container">
                                                <span class="help-text" id="place-text">
                                                    &#8226; Επιτρέπετε να επιλέξετε στίγμα, μόνο εντός των γεωγραφικών συνόρων <br>της Ελλάδας. Οτιδήποτε, εκτός των οριοθετημένων περιοχών με γραμμή μπλε χρώματος,
                                                     θεωρείται <strong>μη αποδεκτή τιμή</strong>.<br>
                                                </span>    
                                                <span class="close-help">&times;</span>
                                            </div>
                                    </p>
                                    
                                    <div class='coords-inline'>

                                        <div class="coords-map-latitude">
                                            <label class="form-check-label" for="regionInput">Νομός:</label>
                                            <input class="panel-field" type="text" name="placeInput" id="regionInput" placeholder="Νομός εγκατάστασης" 
                                            title="Το πεδίο συμπληρώνεται αυτόματα" readonly required>
                                        </div>
                                        
                                        <div class="coords-map-latitude">
                                            <label class="form-check-label" for="latitude">Πλάτος &deg;</label>
                                            <input type="number" name="latitude" id="latitude" step="0.000001" title="Το πεδίο συμπληρώνεται αυτόματα" readonly required>
                                        </div>
                                        <div class="coords-map-longitude">
                                            <label class="form-check-label" for="longitude">Μήκος &deg;</label>
                                            <input type="number" name="longitude" id="longitude" step="0.000001" title="Το πεδίο συμπληρώνεται αυτόματα" readonly required>
                                        </div>
                                        
                                    </div>

                                    <span id="error-message-panel">Please enter a valid value</span>
                                </div>
                                <div id="map"></div>
                        </div>

                        <!-- PANEL 2 -->
                        <!-- Here you select installation place -->
                        <div class="panel-calculator" id="panel2">
                            <div class="title-panel">
                                <span class="number"> 2 </span>
                                <h4>Εγκατάσταση</h4>
                            </div>

                                <div class="option-selector-margin" title="Παρακαλούμε, επιλέξτε εάν η εγκατάσταση θα βρίσκεται σε στέγη ή ταράτσα.">

                                    <p>
                                        <label for="roof" class="spacer-label">Επιλέξτε θέση Εγκατάστασης στην οικία σας: </label>
                                        <button class="help-popper" type="button" title="help-button">
                                            <i class="fa fa-question-circle" id="installation-info"></i>
                                        </button>
    
                                            <div class="help-container">
                                                <span class="help-text" id="installation-text">
                                                    &#8226; Η εγκατάσταση σε <strong>ταράτσα</strong> απαιτεί περισσότερο χώρο σε τ.μ. Αυτό οφείλεται στην ύπαρξη συνήθως καποιου δώματος 
                                                    ή άλλων μέσων που προκαλούν σκιάσεις, όπως κεραίες και ηλιακοί θερμοσίφωνες.<br><br>

                                                    &#8226; Εφόσον γνωρίζετε, επιλέξτε κατά προσέγγιση το ποσοστό σκιάσεων. <strong>Οι σκιάσεις έχουν σημαντική βαρύτητα στην παραγωγή ηλεκτρικής ενέργειας ενός ΦΒ συστήματος</strong>.
                                                    Όταν εντοπίζονται περισσότερες σκιάσεις, επηρεάζεται ανάλογα και η περίοδος απόσβεσης, με αυξητική τάση. Η προεπιλογή είναι στο χαμηλό ποσοστό, το οποίο είναι το βέλτιστο.
                                                </span>    
                                                <span class="close-help">&times;</span>
                                            </div>
                                    </p>
                                    <div id="installation-shadings">
                                        <div>
                                             <div class="spacer-in-calculator-panel">
                                            </div>

                                            <div class="form-check" >
                                                <input type="radio" class="form-check-input" id="roof" name="installation" value="roof" checked>
                                                <label class="form-check-label" for="roof">Στέγη</label>
                                            </div>

                                            <div class="form-check">
                                                <input type="radio" class="form-check-input option2" id="terrace" name="installation" value="terrace">
                                                <label class="form-check-label" for="terrace">Ταράτσα</label>
                                            </div>
                                        </div>
                                       

                                        <div class="shadings-input">
                                            <label class="form-check-label" for="shadings_slider" title="Προαιρετικά, εάν εντοπίσατε σκιάσεις στο χώρο εγκατάστασης, επιλέξτε ανάλογα το ποσοστό">Ποσοστό Σκιάσεων: </label>
                                            <div class="shadings-container">
                                                <input type="range" id="shadings_slider" name="shadings_slider" min="1" max="3" step="1" value="1" required>
                                                <div class="slider-labels">
                                                    <span class="slider-label" id="slider-shadings-low" >Χαμηλό</span>
                                                    <span class="slider-label" id="slider-shadings-medium">Μέτριο</span>
                                                    <span class="slider-label" id="slider-shadings-high">Υψηλό</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    
                                </div>            

                                    <div class="option-selector-margin" title="Παρακαλούμε, επιλέξτε είδος Φ/Β πάνελ και παραμέτρους.">
                                        <p>
                                            <label for="panelParams" class="spacer-label">Επιλέξτε είδος Φ/Β πάνελ:</label>

                                            <button class="help-popper" type="button" title="help-button">
                                                <i class="fa fa-question-circle" id="panels-info"></i>
                                            </button>
        
                                                <div class="help-container">
                                                    <span class="help-text" id="panels-text">
                                                        &#8226; Μπορείτε να επιλέξετε ένα εκ των 5 τύπων ηλιακών πάνελ, από την παρακάτω λίστα. Η επιλογή σας θα βοηθήσει στον υπολογισμό 
                                                        του αριθμού των <strong>ελάχιστα απαιτούμενων ηλιακών πάνελ</strong>, για εκμηδένιση ετήσιας κατανάλωσης, όπως και της <strong>συνολικής σας επένδυσης</strong>.
                                                         Με επιλογή από τη λίστα, συμπληρώνονται αυτόματα τα παρακάτω πεδία παραμέτρων.<br><br>
                                                          
                                                        &#8226; Μπορείτε να συμπληρώσετε χειροκίνητα τα πεδία παραμέτρων, επιλέγοντας <strong>Προσαρμοσμένες Παράμετροι</strong>
                                                    </span>    
                                                    <span class="close-help">&times;</span>
                                                </div>
                                        </p>

                                        <div class="spacer-in-calculator-panel">
                                        </div>

                                        <select  class="panel-selection-height" name="panel_params" id="panelParams"> 
                                            <option id="defaultPanelParams" value="305" data-efficiency="18.3" data-panel_area="1.67" data-panel_cost="167">Mονοκρυσταλλικό Πάνελ <strong>305Wp</strong> (Βαθμός απόδοσης : ≥18,3%)</option>
                                            <option value="340" data-efficiency="16.5" data-panel_area="2.06" data-panel_cost="188">Πολυκρυσταλλικό Πάνελ <strong>340Wp</strong> (Βαθμός απόδοσης : 16,5%) </option>
                                            <option value="370" data-efficiency="19.1" data-panel_area="1.94" data-panel_cost="199">Mονοκρυσταλλικό Πάνελ <strong>370Wp</strong> (Βαθμός απόδοσης : 19,1%) </option>
                                            <option value="410" data-efficiency="21" data-panel_area="1.95" data-panel_cost="248">Mονοκρυσταλλικό Πάνελ <strong>410Wp</strong> (Βαθμός απόδοσης : 21,0%) </option>
                                            <option value="450" data-efficiency="19.9" data-panel_area="2.2" data-panel_cost="272">Mονοκρυσταλλικό Πάνελ <strong>450Wp</strong> (Βαθμός απόδοσης : 19,9%) </option>
                                        </select>
                                        <div class="custom_parameters">
                                            <label class="form-check-label" for="customParameters" title="Πατήστε εδώ για να συμπληρώσετε διαφορετικές τιμές παραμέτρων">Προσαρμοσμένες Παράμετροι:  </label>
                                            <div class="parameters-checkbox-container">
                                                <input type="checkbox" id="customParameters" value="yes">
                                            </div>
                                            <label class="form-check-label-other" for="otherCosts" title="Πατήστε εδώ για να συμπληρώσετε άλλες προαιρετικές τιμές παραμέτρων">Άλλες Παράμετροι Συστήματος:  </label>
                                            <div class="parameters-checkbox-container">
                                                <input type="checkbox" id="otherCosts" value="yes">
                                            </div>
                                        </div>
                                        
                                    </div>
                                    <div class="panels_parameters">
                                        
                                        <div class="left_panels_parameters">
                                            <label class="form-check-label" for="panelWpInput">Ισχύς Πάνελ: </label>
                                            <input class="lightslategrey" type="number" name="panel_kWp" id="panelWpInput" placeholder="ισχύς" readonly><span class="metrics-special-calculation"> Wp</span>

                                            <label class="form-check-label" for="panelEfficiencyInput">Απόδοση Πάνελ: </label>
                                            <input class="lightslategrey" type="text" name="panel_efficiency" id="panelEfficiencyInput" placeholder="απόδοση"  readonly><span class="metrics-special-calculation"> %</span>

                                        </div>
                                        <div class="left_panels_parameters">
                                            <label class="form-check-label" for="panelAreaInput">Eμβαδόν Πάνελ: </label>
                                            <input class="lightslategrey" type="text" name="panel_area" id="panelAreaInput" placeholder="εμβαδόν"  readonly><span class="metrics-special-calculation"> m²</span>

                                            <label class="form-check-label" for="panelCostInput">Κόστος Πάνελ: </label>
                                            <input class="lightslategrey" type="number" name="panel_cost" id="panelCostInput" placeholder="κόστος"  readonly><span class="metrics-special-calculation"> € </span>

                                        </div>
                                        <div class="right-field-parameters">
                                            <label class="form-check-label" for="installationCostInput">Κόστος Εγκατάστασης: </label>
                                            <input class="lightslategrey" type="number" name="installation_cost" id="installationCostInput" placeholder="κόστος"  readonly><span class="metrics-special-calculation"> €</span>

                                            <label class="form-check-label" for="inverterCostInput">Κόστος Ινβέρτερ: </label>
                                            <input class="lightslategrey" type="text" name="inverter_cost" id="inverterCostInput" placeholder="κόστος"  title="Αν δε δώσετε τιμή, υπολογίζεται αυτόματα με την υποβολή της φόρμας" readonly><span class="metrics-special-calculation"> € </span>
                                        </div>
                                    </div>
                             
                        </div>            

                        <!-- PANEL 3 -->
                        <!-- Here you select Azimuth -->
                        <!-- Here you select PV inclination -->
                        <div class="panel-calculator" id="panel3">
                            <div class="title-panel">
                                <span class="number">3</span>
                                <h4>Αζιμούθιο - Κλίση</h4>
                            </div>
                            <div id="panel-azimuth-tilt">
                                <div class="option-selector-margin" title="Παρακαλούμε, επιλέξτε την κατεύθυνση του PV συστήματος" id="panel-azimuth">
                                    <p> 
                                        <label for="azimuthInput" class="spacer-label">Επιλέξτε προσανατολισμό Φ/Β πάνελ: </label>
                                        <button class="help-popper" type="button" title="help-button">
                                            <i class="fa fa-question-circle" id="azimuth-info"></i>
                                        </button>
    
                                            <div class="help-container">
                                                <span class="help-text" id="azimuth-text">
                                                    &#8226; Για τη γεωγραφική περιοχή της Ελλάδος, το βέλτιστο αζιμούθιο (προσανατολισμός) Φ/Β συστήματος, είναι 
                                                    ο <strong>Νότος</strong> (προεπιλογή), στον οποίο δίνεται η τιμή "0". Όσο περισσότερο προσανατολίζεται το σύστημα <br>
                                                    σας προς το Νότο, τόσο υψηλότερη η απόδοση του.   
                                                </span>    
                                                <span class="close-help">&times;</span>
                                            </div>
                                    </p> 
                
                                    <div>
                                        <img id="compass-photo" src="{% static 'images/compass4.png'%}" alt="photo not found">
                                    </div>

                                    <div class="form-check">
                                        <input type="radio" class="form-check-input" id="north" name="azimuth" value="180">
                                        <label class="form-check-label" id="north-label" for="north"></label>

                                        <input type="radio" class="form-check-input" id="northWest" name="azimuth" value="135">
                                        <label class="form-check-label" id="northWest-label" for="northWest"></label>

                                        <input type="radio" class="form-check-input" id="west" name="azimuth" value="90">
                                        <label class="form-check-label" id="west-label" for="west"></label>

                                        <input type="radio" class="form-check-input" id="southWest" name="azimuth" value="45">
                                        <label class="form-check-label" id="southWest-label" for="southWest"></label>

                                        <input type="radio" class="form-check-input" id="south" name="azimuth" value="0" checked>
                                        <label class="form-check-label" id="south-label" for="south"></label>

                                        <input type="radio" class="form-check-input" id="southEast" name="azimuth" value="-45">
                                        <label class="form-check-label" id="southEast-label" for="southEast"></label>

                                        <input type="radio" class="form-check-input" id="east" name="azimuth" value="-90">
                                        <label class="form-check-label" id="east-label" for="east"></label>

                                        <input type="radio" class="form-check-input" id="northEast" name="azimuth" value="-135">
                                        <label class="form-check-label" id="northEast-label" for="northEast"></label>
                                    </div>

                                    <div>
                                    <label class="azimuth_label" for="azimuthInput" class="azimuth_label">Αζιμούθιο σε &deg; :  </label>
                                    <input class="panel-field azimuth" type="text" id="azimuthInput" title="Το πεδίο συμπληρώνεται αυτόματα, αντίστοιχα με την επιλογή της πυξίδας" readonly>
                                </div>
                                
                                </div>
                                

                                <div class="option-selector-margin" title="Παρακαλούμε, επιλέξτε την κλίση του συστήματος PV" id="panel-tilt">
                                    <p> 
                                        <label for="tilt-slider" class="spacer-label">Επιλέξτε κλίση Φ/Β πάνελ:</label>
                                        <button class="help-popper" type="button" title="help-button">
                                            <i class="fa fa-question-circle" id="tilt-info"></i>
                                        </button>
    
                                            <div class="help-container">
                                                <span class="help-text" id="tilt-text">
                                                    &#8226; Για τη πλειοψηφία της γεωγραφικής περιοχής της Ελλάδος, η βέλτιστη<br>
                                                    γωνία κλίσης Φ/Β συστήματος, εντοπίζεται κοντά στις <strong>30</strong>&deg;. 
                                                    Όσο περισσότερο προσεγγίζει την εν λόγω κλίση το σύστημα, τόσο υψηλότερη η απόδοση του.
                                                </span>    
                                                <span class="close-help">&times;</span>
                                            </div>
                                    </p>

                                        <div class="spacer-in-calculator-panel">
                                        </div>

                                    <!-- <div class="form-check">
                                        <input type="radio" class="form-check-input" id="inclination0" name="inclination" value='0'>
                                        <label class="form-check-label" for="inclination0">0&deg;</label>
                                    </div>

                                    <div class="form-check">
                                        <input type="radio" class="form-check-input" id="inclination15" name="inclination" value='15'>
                                        <label class="form-check-label" for="inclination15">15&deg;</label>
                                    </div>

                                    <div class="form-check">
                                        <input type="radio" class="form-check-input" id="inclination30" name="inclination" value='30' checked>
                                        <label class="form-check-label" for="inclination30">30&deg;</label>
                                    </div> 
                                            
                                    <div class="form-check">
                                        <input type="radio" class="form-check-input" id="inclination45" name="inclination" value='45'>
                                        <label class="form-check-label" for="inclination45">45&deg;</label>
                                    </div>

                                    <div class="img-div-calculator" id="image-container">
                                        <img class="img-tilt" src="{% static 'images/0.png' %}" alt="No Image" tilt="0">
                                        <img class="img-tilt" src="{% static 'images/15.png' %}" alt="No Image" tilt="15">
                                        <img class="img-tilt" src="{% static 'images/30.png' %}" alt="No Image" tilt="30">
                                        <img class="img-tilt" src="{% static 'images/45.png' %}" alt="No Image" tilt="45">

                                        <div>
                                            <input class="panel-field" type="hidden" id="tiltInput" name="tiltInput" readonly>
                                        </div>


                                    </div> -->
                                    <div id="tilt-container">
                                        <div id="image-tilt">
                                            <img id="responsive-tilt-image" src="{% static 'images/degree-chart3-line.png' %}" alt="Responsive Image">
                                        </div>
                    
                                        <div id="steady-line"></div> <!-- This is the steady line element -->

                                        <input type="range" id="tilt-slider" min="0" max="90" step="1" value="0">
                                        <span id="tilt-slider-label">Κλίση: <span id="tilt-slider-value">0°</span> </span>

                                        <div>
                                            <input class="panel-field" type="hidden" id="tiltInput" name="inclination" readonly>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                                      
                        <!-- PANEL 4 -->
                        <!-- Here you select consumption profile -->
                        <!-- Here you select 1) Phase Load & 2) the annual consumption of your house in kWh-->
                        <div class="panel-calculator" id="panel4">
                            <div class="title-panel">
                                <span class="number"> 4 </span>
                                <h4>Προφίλ κατανάλωσης</h4>
                            </div>

                            <div class="option-selector-margin" >

                                <div class="option-selector-margin-select-phase" title="Παρακαλούμε, επιλέξτε Παροχή ρεύματος" >

                                    <p title="Επιλέξτε πρώτα το είδος της παροχής, για να σας επιτραπεί η συμπλήρωση ετήσιας κατανάλωσης!" id="spacer-label-phase-load">
                                        Επιλέξτε Παροχή και KWh:                                     
                                     </p>

                                    <input class="panel-selection-height" type="hidden" name="phase_load" id="phase_load" title="Form from forms.py, to select phase load" required>

                                        {{ form_phase_load.select_phase }}
        
                                    <button class="help-popper" type="button" id="phase-load-button" title="help-button">
                                        <i class="fa fa-question-circle" aria-hidden="true" id="phase-load-info"></i>
                                    </button>
                                    

                                        <div class="help-container">
                                            <span class="help-text" id="phase-load-text">
                                                <strong>Παρακαλώ, συμβουλευτείτε το λογαριασμό παρόχου ρεύματος!!</strong><br><br>
                                                &#8226; <strong>Μονοφασική παροχή</strong>, εάν η συμφωνημένη ισχύς είναι: 8 ή 12 kVΑ!<br>
                                                &#8226; <strong>Τριφασική παροχή</strong>, εάν η συμφωνημένη ισχύς είναι:  > 15 kVΑ!</span>
                                            <span class="close-help">&times;</span>
                                        </div>
                                </div>

                                <div>
                                    <input class="panel-selection-height-consumption" type="number" name="annual_consumption" id="annual_kwh" 
                                        title="Παρακαλώ, συμπληρώστε εκτιμώμενη ετήσια κατανάλωση σε kWh" placeholder="Ετήσια κατανάλωση">
                                    <span>kWh</span>
                                        <button class="help-popper" type="button" title="help-button">
                                          <i class="fa fa-question-circle" aria-hidden="true" id="annual-consumption-info"></i>
                                        </button>
                                    
                                        <div class="help-container">
                                            <span class="help-text" id="annual-consumption-text">
                                                <strong>Συμπληρώστε πρώτα το είδος της παροχής, για να σας επιτραπεί<br>
                                                     η συμπλήρωση ετήσιας κατανάλωσης!</strong><br><br>
                                                &#8594; Υπολογίστε <strong>κατά προσέγγιση</strong>, την ετήσια 
                                                κατανάλωση <br> ηλεκτρικού ρεύματος σε kWh.</span>
                                            <span class="close-help">&times;</span>
                                        </div>
                                        
                                </div>

                                <span id="max-message" style="display: none;">Max value</span>
                                <span id="error-message-panel5">Please enter a valid value</span>
                        
                            </div>

                            <div class="option-selector-margin" title="Σημειώστε το ωράριο, στο οποίο εντοπίζετε τις μεγαλύτερες ανάγκες σε οικιακό ρεύμα.">
                                <p class="spacer-label">Επιλέξτε προφίλ μεγαλύτερης κατανάλωσης ρεύματος:</p>
                              
                                <div id="profile-container">
                                    <div id="profile-radios-container">
                                     <div class="form-check" >
                                     <input type="radio" class="form-check-input" id="day-power" name="profile_consumption" value="day-power" checked>
                                        <label class="form-check-label" for="day-power">Ημερήσιο (08:00 - 20:00)</label>
                                    </div>

                                    <div class="form-check">
                                        <input type="radio" class="form-check-input option2" id="high-day-evening" name="profile_consumption" value="high-day-evening">
                                        <label class="form-check-label" for="high-day-evening">Πρωινό - Απογευματινό <br>(06:00 - 12:00 & 16:00 - 22:00) </label>
                                    </div> 

                                    <div class="form-check">
                                        <input type="radio" class="form-check-input option2" id="evening-power" name="profile_consumption" value="evening-power">
                                        <label class="form-check-label" for="evening-power">Απογευματινό (14:00 - 00:00) </label>
                                    </div> 

                                    <div class="form-check">
                                        <input type="radio" class="form-check-input option2" id="night-power" name="profile_consumption" value="night-power">
                                        <label class="form-check-label" for="night-power">Νυχτερινό (18:00 - 06:00)</label>
                                    </div> 
                                    </div>
                                    
                                    <div id="profile-img-container">
                                        <img class="img-profiles" src="{% static 'images/profile-day.png' %}" alt="No Image" profile="day-power">
                                        <img class="img-profiles" src="{% static 'images/profile-highday-evening.png' %}" alt="No Image" profile="high-day-evening">
                                        <img class="img-profiles" src="{% static 'images/profile-evening.png' %}" alt="No Image" profile="evening-power">
                                        <img class="img-profiles" src="{% static 'images/profile-night.png' %}" alt="No Image" profile="night-power">
                                    </div>
                                </div>

                            </div>
                            

                            <div class="option-selector-margin" title="Συμπληρώστε την τιμή €/kWh του παρόχου σας.">
                                <div class="space-price-kwh"> <span class="spacer-label">Επιλέξτε τιμή προμήθειας Ηλεκτρικής Ενέργειας:</span>
                                       
                                                <button class="help-popper" type="button" title="help-button">
                                                <i class="fa fa-question-circle" aria-hidden="true" id="price-kwh-info"></i>
                                                </button>
                                            
                                                <div class="help-container">
                                                    <span class="help-text price" id="annual-consumption-text">
                                                        &#8594; Η προεπιλεγμένη τιμή προμήθειας για τη ΔΕΗ το μήνα Σεπτέμβριο, ανέρχεται στα <strong>155 €/MWh</strong> <br>
                                                        (ή 0,155 €/kWh), για τις πρώτες 500kWh. Αν θέλετε να βρείτε την τιμή προμήθειας του δικού σας παρόχου, 
                                                        συμβουλευτείτε το λογαριασμό ρεύματος.<br><br>

                                                        &#8594; Μπορείτε να επιλέξετε τιμή αρεσκείας, αλλάζοντας τα 3 δεκαδικά ψηφία. Το ανώτερο όριο είναι 999.<br><br>
                                                        
                                                        &#8594; Eπιπλέον, για να εντοπίσετε τις μηνιαίες τιμές προμήθειας για όλους τους παρόχους, μπορείτε να επισκεφτείτε τη σελίδα της <strong>Ρυθμιστικής Αρχής Ενέργειας</strong> (ΡΑΕ) πατώντας στο link:
                                                        <a href="https://www.rae.gr/katanalotes/times-kai-xreoseis/" title="ΡΑΕ">Ρυθμιστική Αρχή Ενέργειας</a>
                                                    </span>
                                                    <span class="close-help price">&times;</span>
                                                </div>
                                      
                                </div>

                                <label for="price_kwh">Τιμή: </label>
                                <input type="text" id="price_kwh" name="price_kwh" min="0.0" max="0.300" step="0.001" placeholder="τιμή kWh" required>
                                <span> €/kWh</span>
                                    
                            </div>
                        </div>

                        <!-- PANEL 5 -->
                        <!-- Here you select the PV's kWp -->
                        <div class="panel-calculator" id="panel5">
                            <div class="title-panel">
                                <span class="number"> 5 </span>
                                <h4>Ισχύς (KWp)</h4>
                            </div>

                            <div class="option-selector-margin">
                                <div class="slide-container" title="Παρακαλώ, επιλέξτε επιθυμητή ισχύς φωτοβολταϊκού σε kWp">
                                    <p><label for="myRangeSlider" class="spacer-label">Επιλέξτε επιθυμητή Ισχύ: </label>

                                    <button class="help-popper" type="button" title="help-button">
                                        <i class="fa fa-question-circle" id="power-info"></i>
                                    </button>

                                        <div class="help-container">
                                            <span class="help-text" id="power-text">
                                                 <strong>Χειροκίνητη Επιλογή</strong><br>
                                                
                                                
                                                 &ensp;Μπορείτε ελεύθερα να αυξομειώσετε τη συνολική ισχύ, σύμφωνα με τις εξατομικευμένες ανάγκες σας και τα επιτρεπτά όρια.<br><br>

                                                 <strong>Εύρεση βέλτιστης Ισχύος</strong><br>
                                                 
                                                 &ensp;Πατώντας εδώ, θα εμφανιστεί κουμπί υπολογισμού και πατώντας το,  
                                                 θα υπολογιστούν αυτόματα τα kWp του Φ/Β συστήματος, τα οποία απαιτούνται για εκμηδένιση της ετήσιας κατανάλωσής σας.<br>
                                                 <br>

                                                 <b style="color: red;">Προσοχή</b>!<br>Για Μονοφασικό σύστημα Φ/Β, μέγιστη επιτρεπτή Ισχύς 5 kWp.<br>
                                                 Για Τριφασικό σύστημα Φ/Β, μέγιστη επιτρεπτή Ισχύς 10.8 kWp.
                                            </span>
                                             <span class="close-help">&times;</span>
                                        </div></p>

                                        <div class="spacer-in-calculator-panel">         
                                        </div>
                                        <div class="slider-select-manual-auto" id="slider_selection_type">
                                            <div class="form-check" >
                                                <input type="radio" class="form-check-input" id="manual_power" name="power_kWp_method" value="manual-power" checked>
                                                <label class="form-check-label" for="manual_power">Χειροκίνητη επιλογή</label>
                                            </div>
            
                                            <div class="form-check">
                                                <input type="radio" class="form-check-input option2" id="auto_power" name="power_kWp_method" value="auto-power">
                                                <label class="form-check-label" for="auto_power">Εύρεση βέλτιστης Ισχύος </label>
                                            </div>

                                        </div>
                                                                             

                                    <input type="range" id="myRangeSlider" name="myRangeSlider" required>
                                    <p class="slider-power-label">Τιμή: <span id="slider-value"></span> kWp</p> 
                                    <input type="hidden" id="myRangeSliderHidden" name="myRangeSliderHidden" required>
                                        
                                    <span id="error-message-panel6">Παρακαλώ πρώτα επιλέξτε ετήσια κατανάλωση kWh & kWp.</span>
                                </div>
                                
                                <div id="autoPower-button-input" class="">
                                    <div class="button-auto-div">
                                        <input type="hidden" name="buttonClicked" value="true">
                                        <button class="autoPower-button" type="button" id="calculateProductionButton">
                                            Υπολογισμός Απαιτούμενης Ισχύος
                                        </button>
                                    </div>
                                   
                                    <div class="autopower-fields">
                                         <div class="left-autopower-fields">
                                            <div>
                                                <label class="form-check-label-autopower" for="annualProduction">Εκτίμηση Ετήσιας Παραγωγής:</label>
                                                <input type="text" class="lightslategrey" id="annualProduction" name="annual-production" readonly><span class="metrics-special-calculation"> kWh</span>
                                            </div>
                                            <div>
                                                <label class="form-check-label-autopower" for="placeProduction">Ειδική Παραγωγή Πάνελ:</label>
                                                <input type="text" class="lightslategrey" id="placeProduction" readonly><span class="metrics-special-calculation"> kWh/panel</span>
                                            </div>
                                            
                                        </div>

                                        <div class="right-autopower-fields">
                                            <div>
                                                <label class="form-check-label-autopower" for="minimumPanels">Ελάχιστος Αριθμός Πάνελ:</label>
                                                <input type="text" class="lightslategrey" id="minimumPanels" name="minimum_panels" readonly><span class="metrics-special-calculation"> panels</span>
                                            </div>
                                            <div>
                                                <label class="form-check-label-autopower" for="totalArea">Συνολικό Εμβαδόν Πάνελ:</label>
                                                <input type="text" class="lightslategrey" id="totalArea" readonly><span class="metrics-special-calculation"> m²</span>
                                            </div>
                                        </div>
                                    </div>
                                   
                                           

                                       
                                    
                                    <!-- Add the loading bar container -->
                                    <div id="loading-bar-container">
                                        <div id="progressBar"></div>
                                        <div id="completionMessage"></div>
                                    </div>
                                </div>
                                
                            </div>
                            
                        </div>

                        <!-- PANEL 6 -->
                        <!-- Here you select battery kwh -->
                        <!-- Here you select discount percentage -->
                        <div class="panel-calculator" id="panel6">
                            <div class="title-panel">
                                <span class="number"> 6 </span>
                                <h4>Aποθήκευση - Επιδότηση</h4>
                            </div>

                            <div class="option-selector-margin" title="Eπιθυμείτε προσθήκη συσσωρευτών">
                                <p><label for="without_storage" class="spacer-label">Επιθυμείτε προσθήκη συσσωρευτή:</label></p>
                                    
                                <div class="spacer-in-calculator-panel">  
                                </div>

                                <div class="form-check" >
                                    <input type="radio" class="form-check-input" id="without_storage" name="storage" value="without_storage" checked>
                                    <label class="form-check-label" for="without_storage">Xωρίς</label>
                                </div>

                                <div class="form-check">
                                    <input type="radio" class="form-check-input option2" id="with_storage" name="storage" value="with_storage">
                                    <label class="form-check-label" for="with_storage">Με</label>

                                    <div class="hidden-storage">
                                        <label for="battery_capacity_kwh">Iσχύς μπαταρίας (σε kWh):</label>

                                        <button class="help-popper" type="button" title="help-button">
                                            <i class="fa fa-question-circle" id="battery-info"></i>
                                        </button>

                                            <div class="help-container">
                                                <span class="help-text" id="storage-text">
                                                    &#8226; Η <strong>ελάχιστη</strong> τιμή kWh για τον συσσωρευτή είναι ίση με τα kVA της<br> Ισχύος Φ/Β!<br>
                                                    &#8226; Η <strong>μέγιστη</strong> δυνατή τιμή, είναι 10 kWh<br><br>

                                                    Εφόσον γνωρίζετε το κόστος της μπαταρίας μπορείτε να το ορίσετε. Για να σας επιτραπεί ο ορισμός, πατήστε μέσα στο checkbox. 
                                                    Διαφορετικά θα υπολογιστεί μετά την υποβολή φόρμας, σύμφωνα με τις επιλογές σας.
                                                   
                                                </span>    
                                                <span class="close-help">&times;</span>
                                            </div>
                                        <input type="number" class="form-control" id="battery_capacity_kwh" name="battery_capacity_kwh">

                                            <div id="battery-cost-container">
                                                <!-- <label class="form-check-label" for="batteryCost" title="Πατήστε εδώ εάν γνωρίζετε το κόστος της μπαταρίας">Αλλαγή τιμής:  </label> -->
                                                <div class="battery-checkbox-container">
                                                    <input type="checkbox" id="batteryCostButton" value="yes">
                                                    <label class="form-check-label" for="batteryCostButton">Κόστος Μπαταρίας: </label>
                                                    

                                                    <div class="battery-cost-input" title="Εφόσον σας είναι γνωστό, μπορείτε να ορίσετε το κόστος της μπαταρίας">
                                                        <input class="lightslategrey" type="text" name="battery_cost" id="battery_cost" placeholder="κόστος"  title="Αν δε δώσετε τιμή, υπολογίζεται αυτόματα με την υποβολή της φόρμας" readonly><span class="metrics-special-calculation"> € </span>
                                                        <input type="hidden" id="battery_cost_hidden" name="battery_cost_hidden" readonly>
                                                    </div>
                                                </div>
    
                                                
                                            </div>
                                          

                                    </div>

                                            
                                </div>
                            </div>

                            <div class="option-selector-margin" title="Παρακαλούμε, επιλέξτε εάν είστε δικαιούχος έπκπτωσης ή επιδότησης και ποσοστά έκπτωσης">
                                <p><label for="discount" class="spacer-label">Είστε δικαιούχος επιδότησης: </label></p>
                                    
                                <div class="spacer-in-calculator-panel">
                                    
                                </div>

                                <div class="form-check" >
                                    <input type="radio" class="form-check-input" id="no-discount" name="discount" value="no" checked >
                                    <label class="form-check-label" for="no-discount">Όχι</label>
                                </div>

                                <div class="form-check">
                                    <input type="radio" class="form-check-input option2" id="discount" name="discount" value="yes">
                                    <label class="form-check-label" for="discount">Ναι</label>

                                    <div class="hidden-storage" id="discountPercentContainer" style="display: none;" >
                                        <label for="discount_percent">Ποσοστό έκπτωσης ΦΒ Σταθμού (σε %):</label>

                                        <button class="help-popper" type="button" title="help-button">
                                            <i class="fa fa-question-circle" id="discount-info"></i>
                                        </button>
    
                                            <div class="help-container">
                                                <span class="help-text" id="discount-text">
                                                    <ul><li>Ποσοστά έκπτωσης σύμφωνα με το πρόγραμμα <strong>"Φωτοβολταϊκά <br> στη Στέγη"</strong></li></ul>
                                                    
                                                    <img class="img-discount" src="{% static 'images/discount.png' %}" alt="No Image">
                                                    
                                                </span>
                                                 <span class="close-help">&times;</span>
                                            </div>

                                        <select class="form-control discount_percent_select" id="discount_percent" name="discount_percent">
                                            <!-- Add default option -->
                                            <option value="">Επιλέξτε ποσοστό</option>
                                        </select>
                                        <!-- <input type="number" class="form-control" id="discount_percent" name="discount_percent"> -->

                                        <label for="discount_percent_battery">Ποσοστό έκπτωσης Μπαταρίας (σε %):</label>
                                        <button class="help-popper" type="button" title="help-button">
                                            <i class="fa fa-question-circle" id="discount-battery-icon"></i>
                                        </button>
    
                                            <div class="help-container">
                                                <span class="help-text" id="discount-battery-text">
                                                    <ul><li>Ποσοστά έκπτωσης σύμφωνα με το πρόγραμμα <strong>"Φωτοβολταϊκά <br> στη Στέγη"</strong></li></ul>
                                                    
                                                    <img class="img-discount" src="{% static 'images/discount.png' %}" alt="No Image">
                                                    
                                                </span>
                                                 <span class="close-help">&times;</span>
                                            </div>

                                        <select class="form-control discount_percent_battery_select" id="discount_percent_battery" name="discount_percent_battery">
                                            <!-- Add default option -->
                                            <option value="">Επιλέξτε ποσοστό</option>
                                        </select>
                                        <!-- <input type="number" class="form-control" id="discount_percent_battery" name="discount_percent_battery"> -->
                                    </div>

                                </div>
                                <input type="hidden" id="lastPanelField" readonly>
                            </div>
                        </div>
                                           
                </fieldset>

                               
                <div class="my-submit-form">
                    <!-- Previous and Next buttons -->
                    <div>
                        <button type="button" class="form-reset-button" id="resetBtn" title="Σας επιτρέπει να επαναφέρετε όλες τις επιλογές και να ξεκινήσετε από την αρχή"><i class="fas fa-undo"></i> Διόρθωση</button>
                        <button type="button" id="previous-button" title="Βήμα προς τα πίσω"> &#11164; Προηγούμενο</button>
                        <button type="button" id="next-button" title="Βήμα προς τα εμπρός">Επόμενο &#11166;</button>
                    </div>
                    
                    <button class="form-submit-button btn btn-primary" type="button" id="submitBtn" title="Το πλήκτρο Υποβολή ενεργοποιείται στο τελευταίο βήμα">Υποβολή <i class="fa fa-upload"></i></button>
                </div>
                    
                    <!-- Modal -->
                    <div class="modal fade" id="myModal" tabindex="-1" aria-labelledby="myModalLabel" aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h2 class="modal-title fs-5" id="myModalLabel">Υποβολή Φόρμας</h2>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                    <div class="modal-body">
                                        <p> &#8226; Έχετε επιλέξει τα εξής δεδομένα:</p>
                                        <label for="place_modal_value">Νομός:</label>
                                        <input type="text" class="form-control" id="place_modal_value" readonly>
                                        <label for="azimuth_modal_value">Αζιμούθιο (σε &deg;):</label>
                                        <input type="number" class="form-control" id="azimuth_modal_value" readonly>
                                        <label for="tilt_modal_value">Κλίση (σε &deg;):</label>
                                        <input type="number" class="form-control" id="tilt_modal_value" readonly>
                                        <label for="annual_Kwh_modal_value">Ετήσια Κατανάλωση (σε kWh):</label>
                                        <input type="number" class="form-control" id="annual_Kwh_modal_value" readonly>
                                        <label for="profile_modal_value">Προφίλ κατανάλωσης (ωράριο):</label>
                                        <input type="text" class="form-control" id="profile_modal_value" readonly>
                                        <label for="power_modal_value">Ισχύς (σε kWp):</label>
                                        <input type="number" class="form-control" id="power_modal_value" readonly>
                                        <label for="battery_modal_value">Μπαταρία (σε kWh):</label>
                                        <input type="number" class="form-control" id="battery_modal_value" readonly>
                                        <label for="discount_percent_modal_value">Ποσοστό έκπτωσης ΦΒ Σταθμού (σε %):</label>
                                        <input type="number" class="form-control" id="discount_percent_modal_value" readonly>
                                        <label for="discount_percent_battery_modal_value">Ποσοστό έκπτωσης Μπαταρίας (σε %):</label>
                                        <input type="number" class="form-control" id="discount_percent_battery_modal_value" readonly>
                                        <br>
                                        Εάν συμφωνείτε πατήστε <strong>"Υποβολή"</strong>. Διαφορετικά επιστρέψτε και πραγματοποιήστε τις αλλαγές που επιθυμείτε.
                                    </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Επιστροφή</button>
                                    <button type="button" class="btn btn-primary" id="submit_modal">Υποβολή</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </form>

            <!-- <div class="column-calculator-page"></div> -->
        </div>
        
    



{% endblock %}
